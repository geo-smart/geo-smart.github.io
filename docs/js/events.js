"use strict";import{useCachedOrLoad}from"./firebase.js";export async function setUpToastContent(e){const t=e.getAttribute("data-event"),n=(await useCachedOrLoad("events")).find((e=>e.id===t)),a=calculateRemainingTime(n.end);if(!n||!a)return;const i=createToastElement(n);e.parentElement.insertBefore(i,e),e.parentElement.removeChild(e),setUpToastOnClick(i),i.classList.add("show")}function createToastElement(e){const t=document.createElement("a");t.classList.add("rich-text"),t.id="toast",t.href=e.link,t.target="_blank";const n=startsWithVowel(e.name)?"an "+e.name:"a "+e.name,a=calculateRemainingTime(e.start),i=calculateRemainingTime(e.end),s=a?"happening":"ending",r=a||i,o=r.time+" "+r.units;return t.innerHTML=`\n    <img src="assets/info-icon.svg"/>\n    <p>\n      There is <span class="event-name">${n}</span> ${s} in <span class="event-time">${o}</span>! \n      Click to learn more.\n    </p>\n  `,t}function setUpToastOnClick(e){e.addEventListener("click",(t=>{t.preventDefault(),e.classList.add("hide"),setTimeout((()=>{const t=e.getAttribute("href");window.open(t,"_blank")}),500)}))}function startsWithVowel(e){return-1!=="aeiouAEIOU".indexOf(e[0])}function calculateRemainingTime(e){const{seconds:t,nanoseconds:n}=e,a=1e3*t+Math.floor(n/1e6),i=new Date(a)-new Date,s=36e5,r=864e5,o=6048e5;if(i>=o){return{units:"weeks",time:Math.floor(i/o)}}if(i>=r){return{units:"days",time:Math.floor(i/r)}}if(i>=s){return{units:"hours",time:Math.floor(i/s)}}return null}