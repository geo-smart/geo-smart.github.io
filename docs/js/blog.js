"use strict";import{loadCollection,useCachedOrLoad}from"./firebase.js";!function(){window.addEventListener("load",(function(){useCachedOrLoad("posts").then((e=>{t=e,window.dispatchEvent(new Event("posts-loaded"))})),l(document.getElementById("blog-post-return"),n),addEventListener("popstate",(()=>{if("#refresh"===window.location.hash){document.getElementById("blog-loader").classList.remove("hidden"),document.querySelectorAll(".blog-post").forEach((e=>e.remove())),async function(){loadCollection("posts"),window.dispatchEvent(new Event("posts-loaded"))}(),history.pushState("",document.title,window.location.pathname+window.location.search),d(0,"smooth")}else window.location.hash?s():i()})),addEventListener("posts-loaded",o)}));var e=void 0,t=null;function o(){console.log("Populating with loaded posts...");document.getElementById("blog-loader").classList.add("hidden"),function(e){const t=document.querySelector(".blog-list-wrap"),o=document.getElementById("blog-post-item"),n=[];for(let i=0;i<e.length;i++){const d=o.cloneNode(!0);d.classList.add("blog-post"),d.classList.remove("hidden"),d.id="";l(d.querySelector(".blog-summary-wrap"),(()=>{window.location.hash=r(d,i)})),d.querySelector(".blog-item-title").innerHTML=e[i].title,d.querySelector(".blog-item-date").innerHTML=c(e[i].date),d.querySelector(".blog-item-summary").innerHTML=e[i].blurb?e[i].blurb:e[i].body,t.appendChild(d),n.push(d)}!function(e){const t=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&e.target.classList.remove("pre-anim")}))}),{root:null,rootMargin:"0px",threshold:.45});e.forEach((e=>t.observe(e)))}(n)}(t),s()}function n(){i(),history.pushState("",document.title,window.location.pathname+window.location.search)}function i(){void 0!==e?(d(e,"smooth"),e=void 0):(e=window.scrollY,d(0,"smooth")),document.getElementById("blog-items-list").classList.toggle("hidden"),document.getElementById("blog-post").classList.toggle("hidden")}function d(e,t){t=t||"instant",setTimeout((()=>{window.scrollTo({top:e,behavior:t})}),1)}function l(e,t){e.addEventListener("click",t),e.addEventListener("keydown",(function(e){"Enter"===e.key&&t(e)}))}function s(){if(!t)return;const o=function(e){if(!/#article-[0-9]$/.test(e))return;const o=parseInt(e.replace(/\D/g,""));return t[o-1]}(window.location.hash);o&&(!function(e){i(),document.getElementById("blog-post-title").innerHTML=e.title,document.getElementById("blog-post-date").innerHTML=c(e.date),document.getElementById("blog-post-body").innerHTML=e.body,document.getElementById("blog-post-link").href=e.link}(o),void 0===e&&(e=0))}function r(e,o){return`article-${(o=void 0!==o?o:t.findIndex((t=>{t.title,e.title,t.date,e.date,t.body,e.body,t.link,e.link})))+1}`}function c(e){const{seconds:t,nanoseconds:o}=e,n=1e3*t+Math.floor(o/1e6);return new Date(n).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"})}}();